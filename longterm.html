<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é•·ç…§è²»ç”¨ç°¡æ˜“è©¦ç®—</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 720px;
      margin: 30px auto;
      background: #fff;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 {
      color: #005BAC;
    }
    label {
      font-weight: bold;
      margin-top: 12px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .result {
      background: #e7f7ed;
      padding: 16px;
      border-left: 6px solid #28a745;
      margin-top: 20px;
      border-radius: 8px;
    }
    .contact {
      margin-top: 30px;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 10px;
    }
    .btn {
      margin-top: 20px;
      padding: 10px 16px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    .btn:disabled {
      background: #ccc;
    }
    .line-btn {
      background: #00c300;
      display: inline-block;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      text-decoration: none;
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ“… ç…§é¡§è²»ç”¨ç°¡æ˜“è©¦ç®—</h2>

    <label>æ‚¨çš„å§“åï¼š</label>
    <input type="text" id="name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" />

    <label>é€£çµ¡é›»è©±ï¼š</label>
    <input type="text" id="phone" placeholder="è«‹è¼¸å…¥é›»è©±" />

    <label>é ä¼°ç…§é¡§å¹´æ•¸ï¼š</label>
    <input type="number" id="years" placeholder="ä¾‹å¦‚ï¼š5" />

    <label>æ¯æœˆç…§é¡§æ–¹å¼è²»ç”¨ï¼š</label>
    <select id="baseExpense">
      <option value="10000">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ è‡ªè¡Œç…§é¡§ï¼ˆç´„ 10,000ï¼‰</option>
      <option value="30000">ğŸ  å±…å®¶ç…§æœå“¡ï¼ˆç´„ 30,000ï¼‰</option>
      <option value="40000">ğŸ¥ å®‰é¤Šæ©Ÿæ§‹ï¼ˆç´„ 40,000ï¼‰</option>
    </select>

    <label>é†«ç™‚è€—æï¼ˆæœˆï¼‰ï¼š</label>
    <input type="number" id="med" value="3000" />

    <label>ç‡Ÿé¤Šè£œå“ï¼ˆæœˆï¼‰ï¼š</label>
    <input type="number" id="food" value="2000" />

    <button class="btn" onclick="calculate()">é–‹å§‹è©¦ç®—</button>

    <div class="result" id="result" style="display:none"></div>

    <div class="contact">
      <h3>å—å±±äººå£½ å¼µåˆä»</h3>
      <p>LINE IDï¼š@731bpjaj<br>ğŸ“ 0927-779-159</p>
      <a href="https://lin.ee/qQa1RAV" class="line-btn">LINE åŠ å…¥å¥½å‹</a>
      <p>ğŸ“Œ å¦‚éœ€å”åŠ©äº†è§£é•·ç…§ä¿éšªè¦åŠƒï¼Œæ­¡è¿è¯ç¹«æˆ‘</p>
    </div>
  </div>

  <script>
    function calculate() {
      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const years = parseFloat(document.getElementById("years").value);
      const base = parseFloat(document.getElementById("baseExpense").value);
      const med = parseFloat(document.getElementById("med").value);
      const food = parseFloat(document.getElementById("food").value);

      if (!name || !phone || isNaN(years)) {
        alert("è«‹è¼¸å…¥å®Œæ•´è³‡è¨Š");
        return;
      }

      const totalMonthly = base + med + food;
      const total = totalMonthly * 12 * years;

      const resultHTML = `
        <h3>è©¦ç®—çµæœ</h3>
        <p>æ¯æœˆç¸½ç…§é¡§è²»ç”¨ï¼šç´„ <strong>NT$ ${totalMonthly.toLocaleString()}</strong></p>
        <p>ç…§é¡§ ${years} å¹´çš„ç¸½è²»ç”¨ï¼šç´„ <strong>NT$ ${total.toLocaleString()}</strong></p>
        <p>âœ… æœ‰é•·ç…§éšªç•¶å¾Œç›¾ï¼Œé€™äº›è²»ç”¨å°±ä¸å†æ˜¯å®¶äººä¸€è‚©æ‰›èµ·ï¼</p>
      `;
      document.getElementById("result").innerHTML = resultHTML;
      document.getElementById("result").style.display = "block";

      // âœ… æ›¿æ›æˆä½ å¯¦éš›éƒ¨ç½²çš„ç¶²å€
      const url = "https://script.google.com/macros/s/AKfycbwUekuFNBN2SRCeJgghqj4uYRz3T6kmCbJ2umxecbBivsQAXXgukEbVLEu9GD1y2Kw9/exec";

      const payload = {
        type: "longterm",
        name: name,
        phone: phone,
        coveredYears: years,
        expensePerMonth: totalMonthly,
        estimateCost: total
      };

      fetch(url, {
        method: "POST",
        body: JSON.stringify(payload),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(res => res.text())
      .then(msg => console.log("âœ… è³‡æ–™é€å‡ºæˆåŠŸï¼š", msg))
      .catch(err => console.error("âŒ å‚³é€å¤±æ•—ï¼š", err));
    }
  </script>
</body>
</html>
