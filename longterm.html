<script>
  document.getElementById("ltcForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const years = parseFloat(document.getElementById("coveredYears").value);
    const monthly = parseFloat(document.getElementById("expensePerMonth").value);
    const total = years * monthly * 12;

    const resultText = `ğŸ“Š é•·ç…§é ä¼°è²»ç”¨è©¦ç®—çµæœï¼š<br>
ğŸ§“ ${years} å¹´ Ã— æ¯æœˆ ${monthly.toLocaleString()} å…ƒ Ã— 12 å€‹æœˆ<br>
â¡ï¸ é ä¼°ç¸½æ”¯å‡ºï¼šç´„ <strong>${total.toLocaleString()}</strong> å…ƒ`;

    document.getElementById("result").innerHTML = resultText;

    const payload = {
      type: "longterm",
      name: document.querySelector("input[name='name']").value,
      phone: document.querySelector("input[name='phone']").value,
      coveredYears: years,
      expensePerMonth: monthly,
      estimateCost: total
    };

    fetch("https://script.google.com/macros/s/AKfycbxXzyOUR_COMMON_EXEC_URL/exec", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    })
    .then(res => res.json())
    .then(res => {
      if (res.result === "success") {
        document.getElementById("result").innerHTML += "<br><br>âœ… è©¦ç®—å®Œæˆï¼Œå»ºè­°ç›¡æ—©æº–å‚™é•·ç…§ä¿éšœï¼";
      } else {
        document.getElementById("result").innerHTML += "<br><br>âš ï¸ ç³»çµ±éŒ¯èª¤ï¼š" + res.message;
      }
    })
    .catch(err => {
      document.getElementById("result").innerHTML += "<br><br>âŒ ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
    });

    e.target.reset();
  });
</script>
