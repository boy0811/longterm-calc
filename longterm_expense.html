<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>å®¶åº­æ”¶æ”¯åˆ†æ Ã— ä¿éšªå»ºè­°</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f0f4f8;
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 720px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #00695c;
    }
    label {
      margin-top: 14px;
      display: block;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      margin-top: 20px;
      padding: 12px;
      background: #00796b;
      color: white;
      border: none;
      width: 100%;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background: #004d40;
    }
    #result {
      margin-top: 30px;
      background: #e0f7fa;
      padding: 20px;
      border-radius: 8px;
    }
    .footer {
      margin-top: 40px;
      font-size: 14px;
      text-align: center;
      color: #555;
    }
    .line-btn {
      margin-top: 12px;
      display: flex;
      justify-content: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>å®¶åº­æ”¶æ”¯åˆ†æ</h1>
    <form id="budgetForm">
      <label>å§“å *</label>
      <input type="text" id="name" required>

      <label>é›»è©± *</label>
      <input type="text" id="phone" required>

      <label>LINE IDï¼ˆå¯é¸å¡«ï¼‰</label>
      <input type="text" id="lineId">

      <label>æ¯æœˆæ”¶å…¥ï¼ˆå…ƒï¼‰ *</label>
      <input type="number" id="income" required>

      <label>æ¯æœˆç”Ÿæ´»é–‹éŠ·ï¼ˆå…ƒï¼‰</label>
      <input type="number" id="living">

      <label>æ¯æœˆå‚µå‹™æ”¯å‡ºï¼ˆå…ƒï¼‰</label>
      <input type="number" id="debt">

      <label>æ¯æœˆé¢¨éšªç®¡ç†æ”¯å‡ºï¼ˆä¿éšªï¼‰ï¼ˆå…ƒï¼‰</label>
      <input type="number" id="risk">

      <label>æ¯æœˆæŠ•è³‡ç†è²¡æ”¯å‡ºï¼ˆå…ƒï¼‰</label>
      <input type="number" id="invest">

      <button type="submit">è©¦ç®—åˆ†æ</button>
    </form>

    <div id="result"></div>

    <div class="footer">
      <p>ğŸ“ å¦‚éœ€å”åŠ©è¦åŠƒä¿å–®ã€è²¡å‹™å»ºè­°æˆ–è£œåŠ©è©¦ç®—ï¼Œæ­¡è¿è¯çµ¡æˆ‘ï¼š</p>
      <p>ğŸ‘¤ é¡§å•ï¼šå—å±±äººå£½ å¼µåˆä»<br>
         â˜ é›»è©±ï¼š0927-779-159<br>
         ğŸ’¬ LINEï¼š@731bpjaj</p>
      <div class="line-btn">
        <a href="https://lin.ee/qQa1RAV" target="_blank">
          <img src="https://scdn.line-apps.com/n/line_add_friends/btn/zh-Hant.png" alt="åŠ å…¥å¥½å‹" height="40" border="0">
        </a>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("budgetForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const name = document.getElementById("name").value;
      const phone = document.getElementById("phone").value;
      const lineId = document.getElementById("lineId").value;
      const income = +document.getElementById("income").value;
      const living = +document.getElementById("living").value || 0;
      const debt = +document.getElementById("debt").value || 0;
      const risk = +document.getElementById("risk").value || 0;
      const invest = +document.getElementById("invest").value || 0;

      const totalExpense = living + debt + risk + invest;
      const balance = income - totalExpense;
      const savingRate = Math.round((balance / income) * 100);

      const percentLiving = Math.round((living / income) * 100);
      const percentDebt = Math.round((debt / income) * 100);
      const percentRisk = Math.round((risk / income) * 100);
      const percentInvest = Math.round((invest / income) * 100);

      function comment(actual, target, type) {
        if (type === "debt") {
          if (actual === 0) return "ğŸ‘‰ âœ… ç„¡å‚µå‹™ï¼Œè‰¯å¥½";
          if (actual < target) return "ğŸ‘‰ âœ… å¯æ¥å—";
          return "ğŸ‘‰ åé«˜";
        }
        if (type === "invest") {
          if (actual === 0) return "ğŸ‘‰ å°šæœªé…ç½®";
          if (actual < target) return "ğŸ‘‰ åä½";
          return "âœ… åˆç†";
        }
        if (type === "living") {
          if (actual < 20) return "ğŸ‘‰ éå¸¸ç¯€çœ";
          if (actual < 40) return "ğŸ‘‰ åä½";
          return "âœ… åˆç†";
        }
        // é¢¨éšªç®¡ç†
        if (actual === 0) return "ğŸ‘‰ å°šæœªé…ç½®";
        if (actual < target) return "ğŸ‘‰ åä½";
        return "âœ… åˆç†";
      }

      let grade = "C";
      if (savingRate >= 30) grade = "A";
      else if (savingRate >= 15) grade = "B";

      let resultHTML = `
        âœ… è©¦ç®—å®Œæˆï½œğŸ“£ è©•ç´šï¼š${grade}<br><br>
        ğŸ™‹ å§“åï¼š${name}<br>
        ğŸ“± é›»è©±ï¼š${phone}<br>
        ${lineId ? "ğŸ’¬ LINE IDï¼š" + lineId + "<br>" : ""}
        <br>âœ… æ”¶å…¥ç¸½é¡ï¼š${income.toLocaleString()} å…ƒ<br><br>
        ğŸ”¹ ç”Ÿæ´»é–‹éŠ·ï¼š${percentLiving}%ï¼ˆå»ºè­° 40%ï¼‰${comment(percentLiving, 40, 'living')}<br>
        ğŸ”¹ å‚µå‹™æ”¯å‡ºï¼š${percentDebt}%ï¼ˆå»ºè­° 20%ï¼‰${comment(percentDebt, 20, 'debt')}<br>
        ğŸ”¹ é¢¨éšªç®¡ç†ï¼š${percentRisk}%ï¼ˆå»ºè­° 20%ï¼‰${comment(percentRisk, 20, 'risk')}<br>
        ğŸ”¹ æŠ•è³‡ç†è²¡ï¼š${percentInvest}%ï¼ˆå»ºè­° 20%ï¼‰${comment(percentInvest, 20, 'invest')}<br><br>
        ğŸ’° å‰©é¤˜å¯å„²è“„ï¼šç´„ ${balance.toLocaleString()} å…ƒ<br>
        ğŸ’¹ å„²è“„ç‡ï¼šç´„ ${savingRate}%<br>
      `;

      document.getElementById("result").innerHTML = resultHTML;

      fetch("https://script.google.com/macros/s/AKfycbx7azoO8MgHx58yqBxnKhXWrc0n77LkHmlDUxJdqRf8B1ayi1Cc-2hCadbTtNUmqaGn/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          type: "budget",
          name,
          phone,
          lineId,
          income,
          living,
          debt,
          risk,
          invest,
          balance,
          savingRate: savingRate + "%",
          grade
        })
      });
    });
  </script>
</body>
</html>
